const data=[
   { 
    id : 0,
    img : 'https://image.made-in-china.com/2f0j00ecSGzNZBQWkA/Air-Gen2-Generation-1-1-Earphone-Wireless-Headset-for-Air-2.jpg',
    name : 'AirPods collection 2 version',
    price : 12000,
    itemInCart: false
   },
   {
    id : 1,
    img : 'https://object.pscloud.io/cms/cms/Photo/img_0_83_1937_0_6.png',
    name : 'AirPods collection 3 version',
    price : 16000,
    itemInCart: false
   },
   {
    id:  2,
    img: 'https://ae01.alicdn.com/kf/Ha122eab4fe2b4d18b00a59c7bd38988ao/Apple-Airpods-i-in-Pro-kablosuz-kulakl-k-hava-bakla-Pod-Pro.png',
    name: 'AirPods collection pro version',
    price:  20000 ,
    itemInCart: false
   },
   {
   id:  3,
   img: 'https://avatars.mds.yandex.net/i?id=4a744345808f4f5e80eeb5fc15e3df7e525993e6-7020937-images-thumbs&n=13',
   name: 'Galaxy buds',
   price:  10000 ,
   itemInCart: false
  },
  {
    id: 4 ,
    img: 'https://gadgety.ru/upload/resizer2/24/090/0907293e70330f91f0ea525189acece5.jpg',
    name: 'Airdots',
  price:   7000,
  itemInCart: false
 },
 {
    id: 5 ,
    img: 'https://object.pscloud.io/cms/cms/Photo/img_0_83_1946_2_1.jpg',
    name: 'JBLT710BTBLK',
  price:  30000 ,
  itemInCart: false
 },
 {
    id: 6 ,
    img: 'https://ardes.bg/uploads/original/jbl-e25bt-cherven-200452.jpg',
    name: 'Live',
  price:   7500,
  itemInCart: false
 },
 {
    id: 7 ,
    img: 'https://sc04.alicdn.com/kf/Hffa69600cb944375b628ae403196c4ab9.jpg',
    name: 'LivePods',
  price:  8000 ,
  itemInCart: false
 },
 {
    id:  8,
    img: 'https://avatars.mds.yandex.net/get-marketpic/4642727/pic1be7a05d561ed3c6f263f03bb6fdb0d8/orig',
    name: 'Borofone',
  price: 20000  ,
  itemInCart: false
 },
 {
    id: 9 ,
    img: 'https://videoset.kz/wp-content/uploads/2018/07/BOYA-by-wm4-Canon-Nikon-768x768.jpg',
    name: 'Boya',
  price: 36000  ,
  itemInCart: false
 },
 {
    id:  10,
    img: 'https://ts2.shop/3787-large_default/компактный-стабилизатор-dji-rsc-2.jpg',
    name: 'RSC 2',
  price:  40000 ,
  itemInCart: false
 },
 {
    id: 11 ,
    img: 'https://ts2.shop/4210-large_default/профессиональный-штатив-agm-с-рукояткой.jpg',
    name: 'ПРОФЕССИОНАЛЬНЫЙ ШТАТИВ',
  price:  25000 ,
  itemInCart: false
 },
 {
    id: 12 ,
    img: 'https://object.pscloud.io/cms/cms/Photo/img_0_58_22_0.jpg',
    name: 'Continent C1',
  price: 15000  ,
  itemInCart: false
 },
 {
    id:  13,
    img: 'https://sc01.alicdn.com/kf/Hf81b5eb91c6a458ea7832d542494953aY/231046036/Hf81b5eb91c6a458ea7832d542494953aY.jpg',
    name: 'Asik Black ',
  price: 30000  ,
  itemInCart: false
 },
 {
    id: 14 ,
    img: 'https://photodelo.kz/image/catalog/photos/video-svet/kolcevye-lampy/lf-r480-led-kit/kolcevojosvetitellf-r480led-15.jpg',
    name: 'LF-R480',
  price:  11500 ,
  itemInCart: false
 },
 {
    id:  15,
    img: 'https://www.cined.com/content/uploads/2019/04/Rode-wireless-go-1.jpg',
    name: 'wireless',
  price:  35000 ,
  itemInCart: false
 },
 {
    id: 16 ,
    img: 'https://object.pscloud.io/cms/cms/Photo/img_0_81_3880_0_1.jpg',
    name: 'iPhone 14 Silicone',
  price: 22000  ,
  itemInCart: false
 },
 {
    id:  17,
    img: 'https://api.fmobile.kz/image//media/sale/image/240062304-w640-h640-chehol-dlya-apple.png',
    name: 'iPhone 13 Pro Clear',
  price:  16000 ,
  itemInCart: false
 },
 {
    id: 18 ,
    img: 'https://api.fmobile.kz/image//media/sale/image/red_YeQLo74.png',
    name: 'Iphone 11 Red',
  price:  2000 ,
  itemInCart: false
 },
 {
    id:19  ,
    img: 'https://object.pscloud.io/cms/cms/Photo/img_0_81_3870_0_6.png',
    name: 'iPhone 14 Pro Max Leather',
  price:  15000 ,
  itemInCart: false
 },
 {
    id: 20 ,
    img: 'https://object.pscloud.io/cms/cms/Photo/img_0_81_2981_1_6.png',
    name: 'Galaxy S22+ Silicone',
  price:  7000 ,
  itemInCart: false
 },
 {
    id: 21 ,
    img: 'https://object.pscloud.io/cms/cms/Photo/img_0_81_3018_4_1.jpg',
    name: 'Galaxy A33 Card',
  price:  5000 ,
  itemInCart: false
 },
 {
    id: 22 ,
    img: 'https://ae01.alicdn.com/kf/HTB1tjARNjTpK1RjSZKPq6y3UpXaI/Xiaomi-mi-9-3.jpg',
    name: 'Redmi 10X 5G',
  price:  4500 ,
  itemInCart: false
 },
 {
    id: 23 ,
    img: 'https://lastprint.ru/image/constructor_avatar_cache/product_195407_1430_0_0.jpg',
    name: 'AX7 case',
  price: 3000  ,
  itemInCart: false
 }
];
let cartList=[]; 
var i;
var detail =document.getElementsByClassName('des');
var detailsImg = document.getElementById('details-img')
var detailTitle = document.getElementById('detail-title')
var detailPrice = document.getElementById('detail-price')
var youSave = document.getElementById('you-save');
var detailsPage = document.getElementById('details-page');
var back = document.getElementById('buy')
back.addEventListener('click',refreshPage)
var addToCarts = document.querySelectorAll('#cart')
var cart = document.getElementById('cart-link');


cart.addEventListener('click',displayCart)

var carts = document.getElementById('carts');

carts.addEventListener('click',()=>addToCart(getId))

var home = document.getElementById('logo');

home.addEventListener('click',hideCart);

document.addEventListener('click',function (e){
    if(e.target.id=='remove'){
        var itemId = e.target.parentNode.id
        removeFromCart(itemId)
    }
})

for(i=0;i<data.length;i++){
    detail[i].addEventListener('click',handleDetail)
}

var getId;

addToCarts.forEach(val=>val.addEventListener('click',()=>addToCart(val.parentNode.id)));

function handleDetail(e){
    detailsPage.style.display = 'block'
    getId= this.parentNode.id;
    detailsImg.src= data[getId].img;
    detailTitle.innerHTML=   data[getId].name;
    detailPrice.innerHTML= 'Цена :  ' +data[getId].price + 'tg';
}

function addToCart(id) {
    if(!data[id].itemInCart){
        cartList= [...cartList,data[id]];
        addItem()
        
        alert('item added to your cart')

    }
    else{
        alert('your item is already there')
    }
    data[id].itemInCart= true
}

function refreshPage(){
    detailsPage.style.display = 'none'
}

function hideCart(){
    document.getElementById('main').style.display= "block";
    document.getElementById('cart-container').style.display= "none";
}

function displayCart(){
    document.getElementById('main').style.display= "none";
    document.getElementById('details-page').style.display= "none";
    document.getElementById('cart-container').style.display= "block";
    if(cartList.length==0){
        document.getElementById('cart-with-items').style.display= "none";
        document.getElementById('empty-cart').style.display= "block";
    }
    else{
        document.getElementById('empty-cart').style.display= "none";
        document.getElementById('cart-with-items').style.display= "block";
        
    }
}

var totalAmount;
var totalItems;
var totalSaving;

function addItem(){
    totalAmount=0;
    totalItems = 0;
    totalSaving=0
    var clrNode=document.getElementById('item-body');
        clrNode.innerHTML= '';
        console.log(clrNode.childNodes)
        cartList.map((cart)=>
        {
            var cartCont = document.getElementById('item-body');
            totalAmount = totalAmount + cart.price;
            totalSaving = totalSaving + cart.save;
            totalItems = totalItems + 1;

            var tempCart = document.createElement('div')
            tempCart.setAttribute('class','cart-list');
            tempCart.setAttribute('id',cart.id);

            var listImg = document.createElement('img');
            listImg.setAttribute('id','list-img');
            listImg.src = cart.img
            tempCart.appendChild(listImg)

            var listName = document.createElement('h3');
            listName.setAttribute('class','list-name');
            listName.innerHTML = cart.name;
            tempCart.appendChild(listName)

            var listPay = document.createElement('h3');
            listPay.setAttribute('class','pay');
            listPay.innerHTML = cart.price;
            tempCart.appendChild(listPay);

            var listQuantity = document.createElement('h3');
            listQuantity.setAttribute('class','quantity');
            listQuantity.innerHTML = '1';
            tempCart.appendChild(listQuantity);

            var listTrash = document.createElement('i');
            listTrash.setAttribute('class','fa fa-trash ');
            listTrash.setAttribute('id','remove');
            tempCart.appendChild(listTrash);

            cartCont.appendChild(tempCart)
            
        })
        document.getElementById('total-amount').innerHTML = 'Общая сумма : ' + totalAmount + 'tg';
        document.getElementById('total-items').innerHTML = 'Все : ' + totalItems;
        document.getElementById('total').style.display= "block";
}

function removeFromCart(itemId){
    data[itemId].itemInCart = false
    cartList = cartList.filter((list)=>list.id!=itemId);
    addItem()
    if(cartList.length==0){
        document.getElementById('cart-with-items').style.display= "none";
        document.getElementById('empty-cart').style.display= "block";
    }
}